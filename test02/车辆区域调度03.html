<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>区域车辆调度02</title>
    <script src="../js/echarts.js" type="text/javascript"></script>
    <script src="../js/bmap.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="../js/angular.min.js"></script>
    <script src="../js/hefei.js" type="text/javascript"></script>
    <script type="text/javascript" src="../js/lodash.js"></script>
    <script type="text/javascript" src="../js/ng-echarts.js"></script>
    <script type="text/javascript" src="../js/getscript.js"></script>
    <script type="text/javascript" src="../js/echarts-gl.js"></script>
</head>
<body>

<div id="mapOption" style="height: 450px;width:65%;" ng-app="app" ng-controller="ctrl"></div>
<script type="text/javascript">
    var app = angular.module('app', []);
    app.controller('ctrl', function ($interval) {
        var ech = document.getElementById('mapOption');
        var color = "#00FFFF";
        var symbolSize = 25;
        var myChart = echarts.init(ech);
        var option;
        var allData = {
            "redPlaces": [{
                "name": "中国科学技术大学车辆停放点", // 中国科学技术大学东区黄金广场31.8372583692,117.2521287762
                "value": [117.2738518410, 31.8465412082, 20],
                "symbolSize": 50,
                "label": {
                    "normal": {
                        "show": true,
                        "position": "inside",
                        "formatter": "需求\n20辆"
                    }
                },
                "itemStyle": {
                    "normal": {
                        "color": "rgba(220,78,73,0.5)" // 红色
                    }
                }
            },
                {
                    "name": "合肥科技馆车辆停放点",
                    "value": [117.2556673903, 31.8472287438, 20],
                    "symbolSize": 50,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "inside",
                            "formatter": "需求\n28辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
//                            "color": "#dc4e49" // 红色
                            "color": "rgba(220,78,73,0.5)"
                        }
                    }
                }],
            "greenPlaces": [
                {
                    "name": "兴都大厦",
                    "value": [117.2792806320, 31.8485098902, 20],
                    "symbolSize": symbolSize,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "6辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                },
                {
                    "name": "合肥学院",
                    "value": [117.2697481142, 31.8457855544, 20],
                    "symbolSize": symbolSize,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "5辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                },
                {
                    "name": "金水花园",
                    "value": [117.2819458309, 31.8435135715, 20],
                    "symbolSize": symbolSize,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "6辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                },
                {
                    "name": "美第阳光大厦",
                    "value": [117.2712286936, 31.8420120926, 20],
                    "symbolSize": 5,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "1辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                },
                {
                    "name": "中国科学技术大学学生宿舍",
                    "value": [117.2766413383, 31.8423667344, 20],
                    "symbolSize": 5,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "2辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                },
                {
                    "name": "摩尔广场",
                    "value": [117.2523249441, 31.8517400335, 20],
                    "symbolSize": symbolSize,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "10辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                },
                {
                    "name": "安徽大学",
                    "value": [117.2614869105, 31.8511264708, 20],
                    "symbolSize": symbolSize,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "8辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                },
                {
                    "name": "中国科技大学西校区",
                    "value": [117.2616156565, 31.8446553550, 20],
                    "symbolSize": symbolSize,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "7辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                },
                {
                    "name": "绿城百合公寓",
                    "value": [117.2524916548, 31.8441662806, 20],
                    "symbolSize": 5,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "2辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                },
                {
                    "name": "黄山路",
                    "value": [117.2498550189, 31.8480749040, 20],
                    "symbolSize": 5,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "1辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                }],
            "line1": [
                {
                    "coords": [
                        [117.2792806320, 31.8485098902],  // 起点 兴都大厦
                        [117.2778107815, 31.8480222808] // 终点 丝绸大厦
//                        [117.2738518410, 31.8465412082]
                    ]
                }, {
                    "coords": [
                        [117.2697481142, 31.8457855544], // 起点 合肥学院
                        [117.2726180248, 31.8465958944]
//                        [117.2738518410, 31.8465412082]
                    ]
                }, {
                    "coords": [
                        [117.2819458309, 31.8435135715], // 起点 金水花园
                        [117.2794952087, 31.8445451406]
//                        [117.2738518410, 31.8465412082]
                    ]
                }, {
                    "coords": [
                        [117.2712286936, 31.8420120926], // 起点 美第阳光大厦
                        [117.2719421082, 31.8436792531]
//                        [117.2738518410, 31.8465412082]
                    ]
                }, {
                    "coords": [
                        [117.2766413383, 31.8423667344], // 起点 中国科学技术大学学生宿舍
                        [117.2756542854, 31.8437703995]
//                        [117.2738518410, 31.8465412082]
                    ]
                }],
            "line2": [
                {
                    "coords": [
                        [117.2523249441, 31.8517400335], // 起点 摩尔广场
                        [117.2536074538, 31.8501635089]
//                        [117.2556673903,31.8472287438]
                    ]
                }, {
                    "coords": [
                        [117.2614869105, 31.8511264708], // 起点 安徽大学
                        [117.2598301787, 31.8499083156]
//                        [117.2556673903,31.8472287438]
                    ]
                }, {
                    "coords": [
                        [117.2616156565, 31.8446553550], // 起点 中国科技大学西校区
                        [117.2589933295, 31.8458068985]
//                        [117.2556673903,31.8472287438]
                    ]
                }, {
                    "coords": [
                        [117.2524916548, 31.8441662806], // 起点 绿城百合公寓
                        [117.2541868109, 31.8456792959]
//                        [117.2556673903,31.8472287438]
                    ]
                }, {
                    "coords": [
                        [117.2498550189, 31.8480749040], // 起点 黄山路
                        [117.2521912474, 31.8477938300]
//                        [117.2556673903,31.8472287438]
                    ]
                }
            ]
        };


        option = {
            backgroundColor: '#00040C',
            title: {
                text: '车辆调度',
                left: 'center',
                textStyle: {
                    color: '#00FFFF'
                }
            },
            legend: {
                show: false,
                orient: 'vertical',
                top: 'bottom',
                left: 'right',
                data: ['地点', '线路'],
                textStyle: {
                    color: '#00FFFF'
                }
            },
            bmap: {
                center: [117.2697910296, 31.8476722274],
                zoom: 16,
                roam: true,
                mapStyle: {
                    styleJson: [
                        {
                            "featureType": "poi",
                            "elementType": "all",
                            "stylers": {
                                "visibility": "off"
                            }
                        },
                        {
                            "featureType": "building",
                            "elementType": "all",
                            "stylers": {
                                "color": "#000000"
                            }
                        },
                        {
                            "featureType": "local",
                            "elementType": "labels",
                            "stylers": {
                                "visibility": "off"
                            }
                        },
                        {
                            "featureType": "subway",
                            "elementType": "all",
                            "stylers": {
                                "visibility": "off"
                            }
                        },
                        {
                            "featureType": "arterial",
                            "elementType": "labels",
                            "stylers": {
                                "visibility": "off"
                            }
                        },
                        {
                            "featureType": "manmade",
                            "elementType": "all",
                            "stylers": {
                                "visibility": "off"
                            }
                        },
                        {
                            "featureType": "building",
                            "elementType": "all",
                            "stylers": {}
                        }
                    ]
                }
            },
            series: [{
                name: '需求地点',
                type: 'effectScatter',
                coordinateSystem: 'bmap',
                zlevel: 2,
                rippleEffect: {
                    scale: 1.5,
                    brushType: 'fill'
                },
                label: {
                    normal: {
                        show: true,
                        position: 'inside',
                        formatter: '需求\n20辆'
                    }
                },
                symbolSize: 1,
                showEffectOn: 'render',
                itemStyle: {
                    normal: {
                        color: 'rgba(70,190,233,1)'
                    }
                },
                data: allData.redPlaces
            }, {
                name: '调度地点',
                type: 'effectScatter',
                coordinateSystem: 'bmap',
                zlevel: 2,
                rippleEffect: {
                    scale: 1.5,
                    brushType: 'fill'
                },
                showEffectOn: 'render',
                data: allData.greenPlaces
            }, {
                type: 'lines',
                coordinateSystem: 'bmap',
                zlevel: 1,
                effect: {
                    show: true,
                    period: 3,
                    trailLength: 0.5,
                    constantSpeed: 50,
                    color: '#ED1B10',
//                    color: '#fff',
                    symbolSize: 10,
                    symbol: 'triangle'
                },
                lineStyle: {
                    normal: {
                        color: "transparent",
//                        color: "rgba(0,176,0,0.8)",
                        width: 0,
                        curveness: 0.1
                    }
                },
                data: allData.line1
            }, {
                type: 'lines',
                coordinateSystem: 'bmap',
                zlevel: 1,
                effect: {
                    show: true,
                    period: 3,
                    trailLength: 0.5,
                    constantSpeed: 50,
                    color: '#ED1B10',
//                    color: '#fff',
                    symbolSize: 10,
                    symbol: 'triangle'
                },
                lineStyle: {
                    normal: {
                        color: "transparent",
//                        color: "rgba(0,176,0,0.8)",
                        width: 0,
                        curveness: 0.1
                    }
                },
                data: allData.line2

            }

            ]
        };
        myChart.setOption(option);

//        // 添加信息窗口
//        var backMarker1 = new BMap.Marker(new BMap.Point(117.2760735379, 31.8432697953)); // 远处点
//        var backMarker2 = new BMap.Marker(new BMap.Point(117.2511475442, 31.8377418537));
//
//        function addOverlay() {
//            backMarker1.hide();
//            backMarker2.hide();
//            var baiduMap = myChart.getModel().getComponent('bmap').getBMap();
//            var point = new BMap.Point(117.2760735379, 31.8432697953);
//            var point2 = new BMap.Point(117.2511475442, 31.8377418537);
//
//            // 添加背景框
//            var myIcon = new BMap.Icon('../img/infowindow4.png', new BMap.Size(340, 130));
//            var opts1 = {
//                offset: new BMap.Size(-25, -155), // 设置偏移量
//                icon: myIcon
//            };
//            var opts2 = {
//                offset: new BMap.Size(160, -360), // 设置偏移量
//                icon: myIcon
//            };
//            backMarker1 = new BMap.Marker(point, opts1);
//            backMarker2 = new BMap.Marker(point2, opts2);
//            baiduMap.addOverlay(backMarker1);
//            baiduMap.addOverlay(backMarker2);
//
//            // 添加信息
//            var styles = {
//                color: "white",
//                fontSize: "16px",
//                height: "25px",
//                width: '260px',
//                lineHeight: "25px",
//                fontFamily: "微软雅黑",
//                backgroundColor: '#9E3329',
//                borderColor: '#9E3329'
//            };
//
//            var label1 = new BMap.Label('停放点名称:中国科学技术大学\n', {offset: new BMap.Size(0, 6)}); // 创建文本标注对象
//            label1.setStyle(styles);
//            backMarker1.setLabel(label1);
//            var number = Math.round(Math.random() * 50 + 16);
//            var label2 = new BMap.Label('需求车辆:' + number, {offset: new BMap.Size(0, 30)});
//            label2.setStyle(styles);
//            backMarker1.setLabel(label2);
//            var label3 = new BMap.Label('停放点名称:合肥科技馆停放点\n', {offset: new BMap.Size(0, 6)}); // 创建文本标注对象
//            label3.setStyle(styles);
//            backMarker2.setLabel(label3);
//            var number = Math.round(Math.random() * 50 + 16);
//            var label4 = new BMap.Label('需求车辆:' + number, {offset: new BMap.Size(0, 30)});
//            label4.setStyle(styles);
//            backMarker2.setLabel(label4);
//        }
//
//        addOverlay();
//
//        $interval(function () {
//            addOverlay();
//        }, 1000, 2)
    });
</script>
</body>
</html>






