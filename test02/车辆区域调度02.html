<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>区域车辆调度02</title>
    <script src="../js/echarts.js" type="text/javascript"></script>
    <script src="../js/bmap.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="../js/angular.min.js"></script>
    <script src="../js/hefei.js" type="text/javascript"></script>
    <script type="text/javascript" src="../js/lodash.js"></script>
    <script type="text/javascript" src="../js/ng-echarts.js"></script>
    <script type="text/javascript" src="../js/getscript.js"></script>
    <script type="text/javascript" src="../js/echarts-gl.js"></script>
    <script type="text/javascript"
            src="http://api.map.baidu.com/library/TrafficControl/1.4/src/TrafficControl_min.js"></script>
    <script type="text/javascript"
            src="http://api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.js"></script>
    <script type="text/javascript"
            src="http://api.map.baidu.com/library/SearchInfoWindow/1.4/src/SearchInfoWindow_min.js"></script>
    <script type="text/javascript"
            src="http://api.map.baidu.com/library/DistanceTool/1.2/src/DistanceTool_min.js"></script>
    <script type="text/javascript" src="http://api.map.baidu.com/library/LuShu/1.2/src/LuShu_min.js"></script>
    <script type="text/javascript"
            src="http://api.map.baidu.com/library/TextIconOverlay/1.2/src/TextIconOverlay_min.js"></script>
    <script type="text/javascript"
            src="http://api.map.baidu.com/library/MarkerClusterer/1.2/src/MarkerClusterer_min.js"></script>
    <script type="text/javascript" src="http://api.map.baidu.com/library/Heatmap/2.0/src/Heatmap_min.js"></script>
</head>
<body>

<div id="mapOption" style="height: 450px;width:65%;" ng-app="app" ng-controller="ctrl"></div>
<script type="text/javascript">
    var app = angular.module('app', []);
    app.controller('ctrl', function () {
        var ech = document.getElementById('mapOption');
        var color = "#00FFFF";
        var symbolSize = 25;
        var myChart = echarts.init(ech);
        var option;
        var allData = {
            "redPlaces": [{
                "name": "中国科学技术大学车辆停放点", // 中国科学技术大学东区黄金广场31.8372583692,117.2521287762   117.273641,31.847251
                "value": [117.2738518410, 31.8465412082, 20],
                "symbolSize": 50,
//                "symbol": "image://../img/bikeDispatcher.gif",
                "label": {
                    "normal": {
                        "show": true,
                        "position": "inside",
                        "formatter": "需求\n20辆"
                    }
                },
                "itemStyle": {
                    "normal": {
                        "color": "rgba(220,78,73,0.5)" // 红色
//                        "color": "transparent"
                    }
                }
            },
                {
                    "name": "合肥科技馆车辆停放点",
                    "value": [117.2556673903, 31.8472287438, 20],
                    "symbolSize": 50,
//                    "symbol": "image://../img/bikeDispatcher.gif",
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "inside",
                            "formatter": "需求\n28辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
//                            "color": "#dc4e49" // 红色
                            "color": "rgba(220,78,73,0.5)"
//                            "color": "transparent"
                        }
                    }
                }],
            "greenPlaces": [
                {
                    "name": "兴都大厦",
                    "value": [117.2792806320, 31.8485098902, 20],
                    "symbolSize": symbolSize,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "6辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                },
                {
                    "name": "合肥学院",
                    "value": [117.2697481142, 31.8457855544, 20],
                    "symbolSize": symbolSize,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "5辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                },
                {
                    "name": "金水花园",
                    "value": [117.2819458309, 31.8435135715, 20],
                    "symbolSize": symbolSize,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "6辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                },
                {
                    "name": "美第阳光大厦",
                    "value": [117.2712286936, 31.8420120926, 20],
                    "symbolSize": 5,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "1辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                },
                {
                    "name": "中国科学技术大学学生宿舍",
                    "value": [117.2766413383, 31.8423667344, 20],
                    "symbolSize": 5,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "2辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                },
                {
                    "name": "摩尔广场",
                    "value": [117.2523249441, 31.8517400335, 20],
                    "symbolSize": symbolSize,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "10辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                },
                {
                    "name": "安徽大学",
                    "value": [117.2614869105, 31.8511264708, 20],
                    "symbolSize": symbolSize,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "8辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                },
                {
                    "name": "中国科技大学西校区",
                    "value": [117.2616156565, 31.8446553550, 20],
                    "symbolSize": symbolSize,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "7辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                },
                {
                    "name": "绿城百合公寓",
                    "value": [117.2524916548, 31.8441662806, 20],
                    "symbolSize": 5,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "2辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                },
                {
                    "name": "黄山路",
                    "value": [117.2498550189, 31.8480749040, 20],
                    "symbolSize": 5,
                    "label": {
                        "normal": {
                            "show": true,
                            "position": "right",
                            "formatter": "1辆"
                        }
                    },
                    "itemStyle": {
                        "normal": {
                            "color": color // 浅蓝色
                        }
                    }
                }],
            "line1": [
                {
                    "coords": [
                        [117.2792806320, 31.8485098902],  // 起点 兴都大厦
                        [117.2778107815, 31.8480222808] // 终点 丝绸大厦
//                        [117.2738518410, 31.8465412082]
                    ]
                }, {
                    "coords": [
                        [117.2697481142, 31.8457855544], // 起点 合肥学院
                        [117.2726180248, 31.8465958944]
//                        [117.2738518410, 31.8465412082]
                    ]
                }, {
                    "coords": [
                        [117.2819458309, 31.8435135715], // 起点 金水花园
                        [117.2794952087, 31.8445451406]
//                        [117.2738518410, 31.8465412082]
                    ]
                }, {
                    "coords": [
                        [117.2712286936, 31.8420120926], // 起点 美第阳光大厦
                        [117.2719421082, 31.8436792531]
//                        [117.2738518410, 31.8465412082]
                    ]
                }, {
                    "coords": [
                        [117.2766413383, 31.8423667344], // 起点 中国科学技术大学学生宿舍
                        [117.2756542854, 31.8437703995]
//                        [117.2738518410, 31.8465412082]
                    ]
                }],
            "line2": [
                {
                    "coords": [
                        [117.2523249441, 31.8517400335], // 起点 摩尔广场
                        [117.2536074538, 31.8501635089]
//                        [117.2556673903,31.8472287438]
                    ]
                }, {
                    "coords": [
                        [117.2614869105, 31.8511264708], // 起点 安徽大学
                        [117.2598301787, 31.8499083156]
//                        [117.2556673903,31.8472287438]
                    ]
                }, {
                    "coords": [
                        [117.2616156565, 31.8446553550], // 起点 中国科技大学西校区
                        [117.2589933295, 31.8458068985]
//                        [117.2556673903,31.8472287438]
                    ]
                }, {
                    "coords": [
                        [117.2524916548, 31.8441662806], // 起点 绿城百合公寓
                        [117.2541868109, 31.8456792959]
//                        [117.2556673903,31.8472287438]
                    ]
                }, {
                    "coords": [
                        [117.2498550189, 31.8480749040], // 起点 黄山路
                        [117.2521912474, 31.8477938300]
//                        [117.2556673903,31.8472287438]
                    ]
                }
            ]
        };


        option = {
            backgroundColor: '#00040C',
            title: {
                text: '车辆调度',
                left: 'center',
                textStyle: {
                    color: '#00FFFF'
                }
            },
            legend: {
                show: false,
                orient: 'vertical',
                top: 'bottom',
                left: 'right',
                data: ['地点', '线路'],
                textStyle: {
                    color: '#00FFFF'
                }
            },
            bmap: {
                center: [117.2697910296, 31.8476722274],
                zoom: 16,
                roam: true,
                mapStyle: {
                    styleJson: [
                        {
                            "featureType": "land",
                            "elementType": "geometry",
                            "stylers": {
                                "color": "#212121"
                            }
                        },
                        {
                            "featureType": "building",
                            "elementType": "geometry",
                            "stylers": {
                                "color": "#2b2b2b",
                            }
                        },
                        {
                            "featureType": "highway",
                            "elementType": "all",
                            "stylers": {
                                "lightness": -42,
                                "saturation": -91
                            }
                        },
                        {
                            "featureType": "arterial",
                            "elementType": "geometry",
                            "stylers": {
                                "lightness": -77,
                                "saturation": -94
                            }
                        },
                        {
                            "featureType": "green",
                            "elementType": "geometry",
                            "stylers": {
                                "color": "#1b1b1b"
                            }
                        },
                        {
                            "featureType": "water",
                            "elementType": "geometry",
                            "stylers": {
                                "color": "#181818"
                            }
                        },
                        {
                            "featureType": "subway",
                            "elementType": "geometry.stroke",
                            "stylers": {
                                "color": "#181818"
                            }
                        },
                        {
                            "featureType": "railway",
                            "elementType": "geometry",
                            "stylers": {
                                "lightness": -52
                            }
                        },
                        {
                            "featureType": "all",
                            "elementType": "labels.text.stroke",
//                            "elementType": "labels",
                            "stylers": {
                                "color": "#313131",
                            }
                        },
                        {
                            "featureType": "all",
                            "elementType": "labels.text.fill",
                            "stylers": {
                                "color": "#8b8787",
                            }
                        },
                        {
                            "featureType": "manmade",
                            "elementType": "geometry",
                            "stylers": {
                                "color": "#1b1b1b",
                            }
                        },
                        {
                            "featureType": "local",
                            "elementType": "geometry",
                            "stylers": {
                                "lightness": -75,
                                "saturation": -91,

                            }
                        },
                        {
                            "featureType": "subway",
                            "elementType": "geometry",
                            "stylers": {
                                "lightness": -65
                            }
                        },
                        {
                            "featureType": "railway",
                            "elementType": "all",
                            "stylers": {
                                "lightness": -40
                            }
                        },
                        {
                            "featureType": "boundary",
                            "elementType": "geometry",
                            "stylers": {
                                "color": "#8b8787",
                                "weight": "1",
                                "lightness": -29
                            }
                        }
                    ]
                }
            },
            series: [{
                name: '需求地点',
                type: 'effectScatter',
                coordinateSystem: 'bmap',
                zlevel: 2,
                rippleEffect: {
                    scale: 1.5,
                    brushType: 'fill'
                },
                label: {
                    normal: {
                        show: true,
                        position: 'inside',
                        formatter: '需求\n20辆'
                    }
                },
                symbolSize: 1,
//                symbol: "image://../img/bikeDispatcher.gif",
                showEffectOn: 'render',
                itemStyle: {
                    normal: {
                        color: 'rgba(70,190,233,1)'
                    }
                },
                data: allData.redPlaces
            }, {
                name: '调度地点',
                type: 'effectScatter',
                coordinateSystem: 'bmap',
                zlevel: 2,
                rippleEffect: {
                    scale: 1.5,
                    brushType: 'fill'
                },
                showEffectOn: 'render',
                data: allData.greenPlaces
            }, {
                type: 'lines',
                coordinateSystem: 'bmap',
                zlevel: 1,
                effect: {
                    show: true,
                    period: 3,
                    trailLength: 0.5,
                    constantSpeed: 50,
                    color: '#ED1B10',
//                    color: '#fff',
                    symbolSize: 10,
                    symbol: 'triangle'
                },
                lineStyle: {
                    normal: {
                        color: "transparent",
//                        color: "rgba(0,176,0,0.8)",
                        width: 0,
                        curveness: 0.1
                    }
                },
                data: allData.line1
            }, {
                type: 'lines',
                coordinateSystem: 'bmap',
                zlevel: 1,
                effect: {
                    show: true,
                    period: 3,
                    trailLength: 0.5,
                    constantSpeed: 50,
                    color: '#ED1B10',
//                    color: '#fff',
                    symbolSize: 10,
                    symbol: 'triangle'
                },
                lineStyle: {
                    normal: {
                        color: "transparent",
//                        color: "rgba(0,176,0,0.8)",
                        width: 0,
                        curveness: 0.1
                    }
                },
                data: allData.line2

            }

            ]
        };
        myChart.setOption(option);

        // var baiduMap = myChart.getModel().getComponent('bmap').getBMap();
        // var point1 = new BMap.Point(117.2738518410, 31.8465412082);
        // var point2 = new BMap.Point(117.2556673903, 31.8472287438);
        // var myIcon = new BMap.Icon('img/bikeDispatcher.gif', new BMap.Size(300,157));
        // var opts1 = {
        //     offset: new BMap.Size(115, 42), // 设置偏移量
        //     icon: myIcon
        // };
        // var opts2 = {
        //     offset: new BMap.Size(115, 42), // 设置偏移量
        //     icon: myIcon
        // };
        // var marker1 = new BMap.Marker(point1, opts1);
        // var marker2 = new BMap.Marker(point2, opts2);
        // baiduMap.addOverlay(marker1);
        // baiduMap.addOverlay(marker2);

    });
</script>
</body>
</html>
